######################################
##Reglas Yara para DUMPS de memoria ##
######################################

rule ZloaderInjectionInMemory
{
	strings:
		$string1 = "set_url"
		$string2 = "data_before"
		$string3 = "data_inject"
		$string4 = "data_after"
		$string5 = "data_end"
		$string6 = "webfakes"
		$string7 = "webfilters"

	condition:
		all of them

}
rule DridexInjectionInMemory
{
	strings:
		$string1 = "^https://"
		$string2 = "_redirect"

	condition:
		$string1 and $string2

}

rule TinbaInjectionInMemory
{

	strings:
		$string1 = "set_url"
		$string2 = "data_inject"
		$string3 = "webfilters"
	condition:
		($string1 and $string2) and not ($string3)
}

rule ZeusInjectionInMemory
{

	strings:
		$string1 = "set_url"
		$string2 = "data_inject"
		$string3 = "webfilters"
		$string4 = "webfakes"
	
	condition:
		($string1 and $string2 and $string3) and not $string4
}

rule ShiotobInMemory
{
        strings:
                $string1 = "/gate_urlzone/"
                $string2 = "%BOTID%"
                $string3 = "%BOTNET%"

        condition:
                $string1 and $string2 and $string3
}

rule TrickBotInjectionInMemory
{
	strings:
		$string1 = "<sinj>"
		$string2 = "<dinj>"
		$string3 = "<dpost>"

	condition:
		$string1 and $string2 and $string3

